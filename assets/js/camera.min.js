var ChromeSamples={log:function(){var a=Array.prototype.slice.call(arguments).map(function(b){return"string"===typeof b?b:JSON.stringify(b)}).join(" ");document.querySelector("#log").textContent+=a+"\n"},clearLog:function(){document.querySelector("#log").textContent=""},setStatus:function(a){document.querySelector("#status").textContent=a},setContent:function(a){for(var b=document.querySelector("#content");b.hasChildNodes();)b.removeChild(b.lastChild);b.appendChild(a)}};
/Chrome\/(\d+\.\d+.\d+.\d+)/.test(navigator.userAgent)&&56>parseInt(RegExp.$1)&&ChromeSamples.setStatus("Warning! Keep in mind this sample has been tested with Chrome 56.");var imageCapture;function onGetUserMediaButtonClick(){navigator.mediaDevices.getUserMedia({video:!0}).then(function(a){document.querySelector("video").srcObject=a;a=a.getVideoTracks()[0];imageCapture=new ImageCapture(a)})["catch"](function(a){return ChromeSamples.log(a)})}
function onGrabFrameButtonClick(){imageCapture.grabFrame().then(function(a){var b=document.querySelector("#grabFrameCanvas");drawCanvas(b,a)})["catch"](function(a){return ChromeSamples.log(a)})}function onTakePhotoButtonClick(){imageCapture.takePhoto().then(function(a){return createImageBitmap(a)}).then(function(a){var b=document.querySelector("#takePhotoCanvas");drawCanvas(b,a)})["catch"](function(a){return ChromeSamples.log(a)})}
function drawCanvas(a,b){a.width=getComputedStyle(a).width.split("px")[0];a.height=getComputedStyle(a).height.split("px")[0];var c=Math.min(a.width/b.width,a.height/b.height),d=(a.width-b.width*c)/2,e=(a.height-b.height*c)/2;a.getContext("2d").clearRect(0,0,a.width,a.height);a.getContext("2d").drawImage(b,0,0,b.width,b.height,d,e,b.width*c,b.height*c)}
document.querySelector("video").addEventListener("play",function(){document.querySelector("#grabFrameButton").disabled=!1;document.querySelector("#takePhotoButton").disabled=!1});document.querySelector("#getUserMediaButton").addEventListener("click",onGetUserMediaButtonClick);document.querySelector("#grabFrameButton").addEventListener("click",onGrabFrameButtonClick);document.querySelector("#takePhotoButton").addEventListener("click",onTakePhotoButtonClick);